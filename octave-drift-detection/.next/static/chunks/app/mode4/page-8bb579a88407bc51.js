(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[704],{2186:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>n});var r=l(5155),s=l(2115),a=l(1835),i=l(8126),d=l.n(i),o=l(5426),c=l(9509);function n(){var e,t,l,i,n,x,u,m,h,b,g,f,p,v,j,N,y,w,C;let A=(0,s.useRef)(null),[S,M]=(0,s.useState)("CCS"),[R,E]=(0,s.useState)("CC-Di"),[P,D]=(0,s.useState)([]),[L,k]=(0,s.useState)({tableData:[],summary:{totalErrors:0,errorRate:0,misclassificationRate:0,status:""}}),[F,I]=(0,s.useState)({reference:{matrix:[[0,0],[0,0]],labels:["Class A","Class B"],precision:0,recall:0,f1:0,accuracy:0},current:{matrix:[[0,0],[0,0]],labels:["Class A","Class B"],precision:0,recall:0,f1:0,accuracy:0}}),[T,K]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("businessUnit"),t=localStorage.getItem("useCase");e&&M(e),t&&E(t);let l=c.env.NEXT_PUBLIC_API_URL||"http://127.0.0.1:5000";console.log("Attempting to fetch from API base:",l);let[r,s]=await Promise.all([fetch("".concat(l,"/api/metrics?mode=4")).catch(e=>{throw console.error("Metrics fetch failed:",e),Error("Failed to reach metrics API: ".concat(e.message))}),fetch("".concat(l,"/api/errors")).catch(e=>{throw console.error("Errors fetch failed:",e),Error("Failed to reach errors API: ".concat(e.message))})]);if(!r.ok){let e=await r.text();throw console.error("Metrics API error response:",e),Error("Metrics API error: ".concat(r.status," - ").concat(e))}if(!s.ok){let e=await s.text();throw console.error("Errors API error response:",e),Error("Errors API error: ".concat(s.status," - ").concat(e))}let a=await r.json(),i=await s.json();console.log("Successfully fetched data:",{metricsData:a,errorsData:i});let d=(a.kpis||Object.entries(a).map(e=>{let[t,l]=e;return{rowKey:t,value:String(l),status:a.status}})).filter(e=>e.rowKey&&e.value),o={tableData:(i.tableData||[]).filter(e=>e.predicted&&e.actual),summary:i.summary||{totalErrors:0,errorRate:0,misclassificationRate:0,status:""}};D(d),k(o);let n=e=>{let t=d.find(t=>t.rowKey===e);if(!t)return 0;let l=Number(t.value);return isNaN(l)?0:l};I({reference:{matrix:[[n("refTrueA"),n("refFalseB")],[n("refFalseA"),n("refTrueB")]],labels:["Class A","Class B"],precision:n("refPrecision"),recall:n("refRecall"),f1:n("refF1"),accuracy:n("refAccuracy")},current:{matrix:[[n("currTrueA"),n("currFalseB")],[n("currFalseA"),n("currTrueB")]],labels:["Class A","Class B"],precision:n("currPrecision"),recall:n("currRecall"),f1:n("currF1"),accuracy:n("currAccuracy")}})}catch(e){console.error("Error loading data:",e)}finally{K(!1)}})()},[]),(0,r.jsxs)("div",{className:"bg-gray-900 min-h-screen flex flex-col",children:[(0,r.jsxs)(d(),{children:[(0,r.jsx)("title",{children:"Mode 4 | CL Dashboard"}),(0,r.jsx)("link",{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"})]}),(0,r.jsxs)("main",{className:"flex-grow container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"bg-gray-800 rounded-xl shadow-md overflow-hidden p-6 mb-6 border border-gray-700",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-blue-300 mb-4",children:"OCTAVE - CL Dashboard"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"bg-blue-900/30 p-4 rounded-lg border border-blue-800/50",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-blue-200 mb-2",children:"Business Unit"}),(0,r.jsxs)("select",{className:"w-full bg-gray-700 border-blue-600 rounded p-2 text-white",value:S,onChange:e=>{let t=e.target.value;M(t),E(""),localStorage.setItem("businessUnit",t)},children:[(0,r.jsx)("option",{value:"",children:"Select Business Unit"}),(0,r.jsx)("option",{value:"CCS",children:"CCS"}),(0,r.jsx)("option",{value:"JMSL",children:"JMSL"})]})]}),(0,r.jsxs)("div",{className:"bg-blue-900/30 p-4 rounded-lg border border-blue-800/50",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-blue-200 mb-2",children:"Use Case"}),(0,r.jsxs)("select",{className:"w-full bg-gray-700 border-blue-600 rounded p-2 text-white",value:R,onChange:e=>{let t=e.target.value;E(t),localStorage.setItem("useCase",t)},disabled:!S,children:[(0,r.jsx)("option",{value:"",children:S?"Select Use Case":"Select Business Unit first"}),("CCS"===S?["CC-Di","CC-MT"]:"JMSL"===S?["JM-Ch"]:[]).map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{className:"bg-blue-900/30 p-4 rounded-lg border border-blue-800/50",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-blue-200 mb-2",children:"Short Code"}),(0,r.jsx)("input",{type:"text",value:R||"-",readOnly:!0,className:"w-full bg-gray-700 border-blue-600 rounded p-2 text-white"})]}),(0,r.jsxs)("div",{className:"bg-blue-900/30 p-4 rounded-lg border border-blue-800/50",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-blue-200 mb-2",children:"Runtime"}),(0,r.jsx)("input",{type:"text",value:"2h 45m",readOnly:!0,className:"w-full bg-gray-700 border-blue-600 rounded p-2 text-white"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"bg-blue-900/30 p-4 rounded-lg border border-blue-800/50",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-blue-200 mb-2",children:"Current Alert Time"}),(0,r.jsx)("p",{className:"text-xl",children:T?"Loading...":(null===(e=P.find(e=>"alertTime"===e.rowKey))||void 0===e?void 0:e.value)||"N/A"})]}),(0,r.jsxs)("div",{className:"bg-blue-900/30 p-4 rounded-lg border border-blue-800/50",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-blue-200 mb-2",children:"No. of Runtime"}),(0,r.jsx)("p",{className:"text-xl",children:T?"Loading...":(null===(t=P.find(e=>"runtimeCount"===e.rowKey))||void 0===t?void 0:t.value)||"0"})]}),(0,r.jsxs)("div",{className:"bg-blue-900/30 p-4 rounded-lg border border-blue-800/50",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-blue-200 mb-2",children:"Alert Keeper"}),(0,r.jsx)("p",{className:"text-xl",children:T?"Loading...":(null===(l=P.find(e=>"alertKeeper"===e.rowKey))||void 0===l?void 0:l.value)||"N/A"})]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-800 rounded-xl shadow-md overflow-hidden p-6 mb-6 border border-gray-700",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-blue-300 mb-4",children:"Drift Warning Plot"}),(0,r.jsx)("div",{className:"h-64 bg-gray-700 rounded p-4",children:T?(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsx)("div",{className:"text-white",children:"Loading drift warnings..."})}):(0,r.jsx)("div",{className:"relative h-full",children:(0,r.jsx)("canvas",{id:"driftWarningChart",className:"w-full h-full",ref:e=>{if(e&&!T){let s=e.getContext("2d");if(s){var t,l,r;A.current&&A.current.destroy(),A.current=new a.t1(s,{type:"line",data:{labels:null!==(r=null===(t=L.plotData)||void 0===t?void 0:t.map((e,t)=>e.x||"Time ".concat(t+1)))&&void 0!==r?r:[],datasets:[{label:"Drift Level",data:(null===(l=L.plotData)||void 0===l?void 0:l.length)?L.plotData.map(e=>Math.floor(e.y)%3):P.filter(e=>e.rowKey.includes("currentDrift")).map(e=>Math.floor(parseFloat(e.value))%3),borderColor:"rgb(239, 68, 68)",backgroundColor:"rgba(239, 68, 68, 0.1)",tension:.1,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#e5e7eb"}},tooltip:{mode:"index",intersect:!1}},scales:{x:{type:"category",title:{display:!0,text:"Data Points",color:"#93c5fd",font:{weight:"bold"}},grid:{color:"rgba(255, 255, 255, 0.1)"},ticks:{color:"#e5e7eb",font:{size:12}}},y:{title:{display:!0,text:"Drift Value",color:"#93c5fd",font:{weight:"bold"}},beginAtZero:!0,grid:{color:"rgba(255, 255, 255, 0.1)"},ticks:{color:"#e5e7eb",font:{size:12},callback:e=>"number"==typeof e?e.toFixed(2):e}}},animation:{duration:1e3,easing:"easeInOutQuad"},elements:{point:{radius:4,hoverRadius:6}}}})}}}})})})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:(0,r.jsxs)("div",{className:"bg-gray-800 rounded-xl shadow-md overflow-hidden p-6 border border-gray-700",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-blue-300 mb-4",children:"Current Confusion Matrix"}),(0,r.jsx)("div",{className:"h-96 bg-gray-700 rounded p-4",children:T?(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsx)("div",{className:"text-white",children:"Loading current matrix..."})}):(0,r.jsx)(o.A,{data:F.current.matrix,labels:F.current.labels,title:"Current Matrix",width:500,height:500})}),(0,r.jsxs)("div",{className:"mt-4 grid grid-cols-3 gap-2",children:[(0,r.jsxs)("div",{className:"bg-blue-900/20 p-2 rounded",children:[(0,r.jsx)("p",{className:"text-xs text-blue-200",children:"Precision"}),(0,r.jsx)("p",{className:"text-lg font-semibold text-white",children:T?"-":(null===(n=F.current)||void 0===n?void 0:null===(i=n.precision)||void 0===i?void 0:i.toFixed(2))||"N/A"})]}),(0,r.jsxs)("div",{className:"bg-blue-900/20 p-2 rounded",children:[(0,r.jsx)("p",{className:"text-xs text-blue-200",children:"Recall"}),(0,r.jsx)("p",{className:"text-lg font-semibold text-white",children:T?"-":(null===(u=F.current)||void 0===u?void 0:null===(x=u.recall)||void 0===x?void 0:x.toFixed(2))||"N/A"})]}),(0,r.jsxs)("div",{className:"bg-blue-900/20 p-2 rounded",children:[(0,r.jsx)("p",{className:"text-xs text-blue-200",children:"F1"}),(0,r.jsx)("p",{className:"text-lg font-semibold text-white",children:T?"-":(null===(h=F.current)||void 0===h?void 0:null===(m=h.f1)||void 0===m?void 0:m.toFixed(2))||"N/A"})]})]})]})}),(0,r.jsxs)("div",{className:"bg-gray-800 rounded-xl shadow-md overflow-hidden p-6 mb-6 border border-gray-700",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-blue-300 mb-4",children:"Hyperparameters"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"bg-blue-900/30 p-4 rounded-lg border border-blue-800/50",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-blue-200 mb-2",children:"Hyperparameters"}),(0,r.jsx)("p",{className:"text-xl",children:T?"Loading...":(null===(b=P.find(e=>"hyperparameters"===e.rowKey))||void 0===b?void 0:b.value)||"N/A"})]}),(0,r.jsxs)("div",{className:"bg-yellow-900/20 p-4 rounded-lg border border-yellow-800/50",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-yellow-200 mb-2",children:"Status"}),(0,r.jsx)("p",{className:"text-xl ".concat(T?"":(null===(g=P.find(e=>"status"===e.rowKey))||void 0===g?void 0:g.value)==="Warning"?"text-yellow-300":(null===(f=P.find(e=>"status"===e.rowKey))||void 0===f?void 0:f.value)==="Error"?"text-red-400":"text-green-400"),children:T?"Loading...":(null===(p=P.find(e=>"status"===e.rowKey))||void 0===p?void 0:p.value)||"N/A"})]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-800 rounded-xl shadow-md overflow-hidden p-6 mb-6 border border-gray-700",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-blue-300 mb-4",children:"XAI Result"}),(0,r.jsxs)("div",{className:"space-y-3 text-white",children:[(0,r.jsx)("p",{children:(null===(v=P.find(e=>"xaiAnalysis"===e.rowKey))||void 0===v?void 0:v.value)||"Performance analysis loading..."}),(0,r.jsx)("p",{className:"font-medium text-yellow-300",children:(null===(j=P.find(e=>"recommendation"===e.rowKey))||void 0===j?void 0:j.value)||"Recommendation loading..."})]})]}),(0,r.jsxs)("div",{className:"bg-red-900/20 rounded-xl shadow-md overflow-hidden p-6 mb-6 border border-red-800/50",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-red-300 mb-4",children:"Error and Misclassification Percentages"}),(0,r.jsxs)("div",{className:"space-y-3 text-white",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-red-200",children:"Error Rate"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:(null===(N=L.summary)||void 0===N?void 0:N.errorRate)?(100*L.summary.errorRate).toFixed(1)+"%":"N/A"}),(0,r.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-4 mt-2",children:(0,r.jsx)("div",{className:"bg-red-500 h-4 rounded-full",style:{width:"".concat((null===(y=L.summary)||void 0===y?void 0:y.errorRate)?100*L.summary.errorRate:0,"%")}})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-red-200",children:"Misclassification Rate"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:(null===(w=L.summary)||void 0===w?void 0:w.misclassificationRate)?(100*L.summary.misclassificationRate).toFixed(1)+"%":"N/A"})]})]}),(0,r.jsx)("h3",{className:"text-lg font-medium text-red-200 mt-4",children:"Worst Performing Cases"}),(0,r.jsx)("ul",{className:"list-disc pl-5 space-y-1",children:L.tableData.sort((e,t)=>(t.percentageError||0)-(e.percentageError||0)).slice(0,3).map((e,t)=>(0,r.jsxs)("li",{children:[e.timePeriod,": ",e.predicted," \xe2†’ ",e.actual," (",e.percentageError,"% error)"]},t))}),(0,r.jsx)("p",{className:"font-medium text-yellow-300 mt-2",children:(null===(C=L.summary)||void 0===C?void 0:C.status)?"Status: ".concat(L.summary.status):"Status loading..."})]})]}),(0,r.jsxs)("div",{className:"bg-gray-800 rounded-xl shadow-md overflow-hidden p-6 mb-6 border border-gray-700",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-blue-300 mb-4",children:"Misclassified Table"}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-700",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-200 uppercase tracking-wider",children:"ID"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-200 uppercase tracking-wider",children:"Predicted"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-200 uppercase tracking-wider",children:"Actual"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-700",children:T?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:3,className:"px-6 py-4 text-center text-sm text-white",children:"Loading misclassified data..."})}):L.tableData.length>0?L.tableData.map((e,t)=>(0,r.jsxs)("tr",{className:"bg-red-900/10",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:e.id}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-300",children:e.predicted}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:e.actual})]},t)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:3,className:"px-6 py-4 text-center text-sm text-white",children:"No misclassified data available"})})})]})})]})]})]})}a.t1.register(a.PP,a.ZT,a.FN,a.No,a.kc,a.m_,a.s$)},3520:(e,t,l)=>{Promise.resolve().then(l.bind(l,2186))},5426:(e,t,l)=>{"use strict";l.d(t,{A:()=>i});var r=l(5155),s=l(6660),a=l(2115);function i(e){let{data:t,labels:l,title:i,width:d=500,height:o=500,cellSize:c=40,minCellSize:n=20,maxCellSize:x=60}=e,u=(0,a.useRef)(null);return(0,a.useEffect)(()=>{var e,r,a;if(!u.current||!(null==t?void 0:t.length)||!(null==l?void 0:l.length))return;let i=Math.max(100,d||500),m=Math.max(100,o||500),h=Math.min(Math.max(n||20,Math.min((null===(e=u.current)||void 0===e?void 0:e.clientWidth)||i,(null===(r=u.current)||void 0===r?void 0:r.clientHeight)||m)/Math.max(t.length,(null===(a=t[0])||void 0===a?void 0:a.length)||1)),x||60),b=Math.max(10,c||h);u.current.innerHTML="";let g={top:30,right:30,bottom:30,left:30};g.left,g.right,g.top,g.bottom;let f=s.Ltv(u.current).append("svg").attr("width",i).attr("height",m).append("g").attr("transform","translate(".concat(g.left,",").concat(g.top,")")),p=s.exT(s.dM).domain([0,s.T9B(t.flat())||1]);f.selectAll("g").data(t).enter().append("g").selectAll("rect").data((e,t)=>e.map((e,l)=>({value:e,x:l,y:t}))).enter().append("rect").attr("x",e=>e.x*b).attr("y",e=>e.y*b).attr("width",b-1).attr("height",b-1).style("fill",e=>p(e.value)).style("stroke","#fff"),f.selectAll(".row-label").data(l).enter().append("text").attr("x",-5).attr("y",(e,t)=>t*b+b/2).style("text-anchor","end").style("fill","#e5e7eb").text(e=>e),f.selectAll(".col-label").data(l).enter().append("text").attr("y",-5).attr("x",(e,t)=>t*b+b/2).style("text-anchor","middle").style("fill","#e5e7eb").text(e=>e)},[t,l,d,o,c,n,x]),(0,r.jsxs)("div",{className:"relative h-full w-full",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-blue-200 mb-2",children:i}),(0,r.jsx)("div",{ref:u})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[178,589,279,441,684,358],()=>t(3520)),_N_E=e.O()}]);